<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=description content="
        
      "><meta name=keywords content="tabs,vs.,spaces,,line,length,,soft,line,wrap,,align,consecutive,assignments,,grabenkampf"><meta name=generator content="Hugo 0.121.1"><meta name=viewport content="width=device-width,initial-scale=1"><link rel=stylesheet href=/css/style.css><link rel="alternate stylesheet" href=/css/themes/atelier/cave.css title="Atelier Cave"><link rel="alternate stylesheet" href=/css/themes/atelier/dune.css title="Atelier Dune"><link rel="alternate stylesheet" href=/css/themes/atelier/estuary.css title="Atelier Estuary"><link rel="alternate stylesheet" href=/css/themes/atelier/forest.css title="Atelier Forest"><link rel="alternate stylesheet" href=/css/themes/atelier/heath.css title="Atelier Heath"><link rel="alternate stylesheet" href=/css/themes/atelier/lakeside.css title="Atelier Lakeside"><link rel="alternate stylesheet" href=/css/themes/atelier/plateau.css title="Atelier Plateau"><link rel="alternate stylesheet" href=/css/themes/atelier/savanna.css title="Atelier Savanna"><link rel="alternate stylesheet" href=/css/themes/atelier/seaside.css title="Atelier Seaside"><link rel="alternate stylesheet" href=/css/themes/atelier/sulphurpool.css title="Atelier Sulphurpool"><link rel="alternate stylesheet" href=/css/themes/atlas.css title=Atlas><link rel="alternate stylesheet" href=/css/themes/base16/cupcake.css title="Base16 Cupcake"><link rel="alternate stylesheet" href=/css/themes/base16/default.css title="Base16 Default"><link rel="alternate stylesheet" href=/css/themes/base16/eighties.css title="Base16 Eighties"><link rel="alternate stylesheet" href=/css/themes/base16/mocha.css title="Base16 Mocha"><link rel="alternate stylesheet" href=/css/themes/base16/ocean.css title="Base16 Ocean"><link rel=stylesheet href=/css/themes/solarized.css title=Solarized><link rel=alternate href=/index.xml type=application/rss+xml title=similitude><link rel=openid.server href=https://id.sim.ilitu.de/><link rel=openid2.provider href=https://id.sim.ilitu.de/><link rel=me href=https://indieweb.social/@smnscp><link rel=me href=https://github.com/smnscp><link rel=webmention href=https://webmention.io/sim.ilitu.de/webmention><link rel=pingback href=https://webmention.io/sim.ilitu.de/xmlrpc><title>Overcoming Code Format Disputes | similitude</title></head><body class=lyo-page-center><header><section><p><a href=https://sim.ilitu.de/ class=clr-prism-2>similitude</a></p><fieldset class=var-theme-switch><label for=scheme-switch>☾</label>
<input type=range name=scheme-switch min=0 max=1 value=0 step=1 data-behavior=scheme-switch>
<label for=scheme-switch>☼</label></fieldset><fieldset class=var-theme-switch><label for=theme-switch>❮</label>
<input type=range name=theme-switch min=0 max=-1 value=0 step=1 data-behavior=theme-switch style=inline-size:4rem>
<label for=theme-switch>❯</label></fieldset><script src=/js/theme-switch.js defer></script><nav><menu><li><a href=/pages/about/>About</a></li></menu></nav></section></header><main><article class=var-single-article itemscope itemtype=http://schema.org/BlogPosting><dl class=var-meta><dt>published on</dt><dd><time itemprop=datePublished datetime=2023-04-03>April 03, 2023</time></dd><dt>sorted in</dt><dd><a href=/categories/code>code</a></dd></dl><h1 itemprop=headline>Overcoming Code Format Disputes</h1><section class=body itemprop=articleBody><p>Superficially, this article is just about coding style “Grabenkämpfe”<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>. At its core, though, it goes into breaking the circle, understanding your counterpart, being honest about own misconceptions, finding real, constructive middle ground. On a meta-level, we might even take away inspiration for solving everyday life conflicts beyond code style bike-shedding.</p><h2 id=dare-you-question-my-style>Dare You Question My Style!</h2><p>A while ago, a colleague of mine challenged <a href=https://github.com/smnscp/similitude-hugo/blob/096261f80997dcc6bc6b7f4d69352dfc43aa24d2/.prettierrc#L19>my habit to hard-break long lines of prose in Markdown files</a>.</p><figure><pre class=scp-highlight><code class="code-inline language-json"><span class=p>{</span>
  <span class=nt>&#34;overrides&#34;</span><span class=p>:</span> <span class=p>[</span>
    <span class=p>{</span>
      <span class=nt>&#34;files&#34;</span><span class=p>:</span> <span class=p>[</span>
        <span class=s2>&#34;*.md&#34;</span>
      <span class=p>],</span>
      <span class=nt>&#34;options&#34;</span><span class=p>:</span> <span class=p>{</span>
        <span class=nt>&#34;parser&#34;</span><span class=p>:</span> <span class=s2>&#34;markdown&#34;</span><span class=p>,</span>
        <span class=nt>&#34;proseWrap&#34;</span><span class=p>:</span> <span class=s2>&#34;always&#34;</span>
      <span class=p>}</span>
    <span class=p>}</span>
  <span class=p>]</span>
<span class=p>}</span></code></pre><figcaption>.prettierrc</figcaption></figure><p>She said, with soft-wrap turned on, her code editor is taking care of wrapping long lines automatically. And so, not only doesn’t she see any use in hard-wrapping lines, but it’s also spoiling her editor’s effort to display the text in a convenient way.</p><p>I could have given in to the impulse to react annoyed to this perceivedly negligible expression of opinion on a supposedly pure matter of taste. But I didn’t.</p><h2 id=re-thinking-prose-wrap>Re-thinking Prose Wrap</h2><p>Instead, I revised my reasoning for settling on hard wraps and realized that my colleague was totally right and I was wrong.</p><p>Essentially, I had got two reasons: Readability and containment of changes. The former is obvious: <a href=http://webtypography.net/2.1.2>Short lines of text are readable</a>, long lines are not. The latter is a bit obscure: In version control, changes are better traceable if they affect only a short line rather than a whole paragraph. That’s what I thought.</p><p>Well, I should have thought twice. Both my needs turned out to be even better met with soft wrap. Readability (in terms of comfortable line length) is not an issue with soft wrap turned on. One thing that always kept me from relying on soft wrap was that indented lines where turned into a mess. But that’s no longer the case if you use a modern editor that’s taking care of proper indentation of subsequent lines. And when it comes to keeping changes contained to a single short line I had not taken into account that most wording changes would cause re-wrapping of the whole paragraph, anyways. And most diff tools do a good job in visualizing inline changes.</p><p>After all, there is no real advantage in hard line breaks solely for formatting. They are actually just an overhead.</p><p>Ah, wait, I forgot: Of course, restricting line-length is something <a href=https://llvm.org/docs/CodingStandards.html#source-code-width>you just do</a>, no matter what, isn’t it? Well, turns out that Markdown files (and others with long prose contents) are a perfect exception from that rule. Just because I write them in the same editor I use for program code doesn’t mean I cannot handle them differently. In fact, they <em>are</em> different. But some similarity also exists …</p><h2 id=code-formatting-different-but-same>Code Formatting: Different but Same</h2><p>A few weeks later I stumbled upon some lines of code with inline tabular alignment: A group of consecutive assignments with the equal signs all pushed to the same column by bunches of extra spaces.</p><figure><pre class=scp-highlight><code class="code-inline language-ruby">  <span class=n>some_var</span>                          <span class=o>=</span> <span class=mi>42</span>
  <span class=n>another_var</span>                       <span class=o>=</span> <span class=s2>&#34;foo&#34;</span>
  <span class=n>now</span>                               <span class=o>=</span> <span class=no>Time</span><span class=o>.</span><span class=n>now</span>
  <span class=n>yet_another_thing_being_initiated</span> <span class=o>=</span> <span class=n>request</span></code></pre><figcaption>consecutive assignments, rather unrelated</figcaption></figure><p>By “stumble upon” I don’t mean being hit by surprise. Rather, it reminded me of that un-written convention in our team to treat our Ruby code with that kind of “cosmetics”. I’m well aware that some colleagues fancy it due to the assumed better readability. Not me! I don’t. I read code line by line, not column-wise. And I hate to introduce unnecessary formatting dependencies between lines. But not <em>only</em> me! Look at popular code style guides out there: <i>PEP 8</i>, for example, <a href=https://pep8.org/#pet-peeves>lists this no-no under “Pet Peeves”</a>. Need I say more?</p><p>Nevertheless, I normally refrain from starting discussions about things like that, because I know that those arguments are usually fruitless. People have different needs and priorities. Trying to convince each other is mostly weighing in your own needs more important than those of your counterpart. It would only go like this:</p><figure class=no-outdent><p><em>They</em>: “I like the readability gain of aligning consecutive assignments or multi-line dictionaries.”</p><p><em>I</em>: “I don’t want those lines’ formatting to depend on each other’s. It means extra effort and leads to formatting war. And by the way, I despise the alleged readability gain, because it’s at best a slight one.”</p><p>— “I don’t care about the extra formatting effort. Tooling can do this automatically. Readability of code is more important then its maintainability. And the readability improvement is huge!”</p><p>— “No, it’s not. If it is for you, then that’s only subjective. For me it’s actually the opposite. It disturbs my reading flow. It provokes merge conflicts due to different amounts of spaces added or removed in both versions. It obscures code history.”</p><p>— “I have a plug-in that aligns touched lines automatically after resolving merge conflicts. And I don’t care much about code history. If you do, there is <a href=https://git-scm.com/docs/git-blame#Documentation/git-blame.txt--w>a git-blame option</a> that filters out whitespace-only changes.”</p><p>— “It hurts my eyes!”</p><p>— “I like it!”</p><p>— “It hurts my feelings!”</p><p>— “You hurt mine!”</p><p>…</p></figure><p>You see, it’s futile. You can follow <a href=https://stackoverflow.com/questions/101958/code-formatting-is-lining-up-similar-lines-ok>discussions like that</a> and will find similar statements everywhere. Both sides have their reasons and neither side will probably ever convince the other.</p><p>I’ve been using <a href=https://prettier.io/>Prettier</a> in most of my personal projects for the last 5 years. And I’m happy we eventually introduced it for all our front-end code at work. The main simple reason why I love it:</p><blockquote><p>No need to discuss style in code review</p></blockquote><p><small>(And there will never be extraneous whitespace in our TypeScript code. 😌)</small></p><p>On the other hand, I understand why others like that tabular style. Putting things in rectangular boxes has always brought some kind of comfort to humans. And the fact that code formatters have dedicated options for it (e. g. <a href=https://clang.llvm.org/docs/ClangFormatStyleOptions.html#alignconsecutiveassignments><code>AlignConsecutiveDeclarations</code> for Clang-Format</a>) shows that it’s really important to some and accepted by many.</p><p>Realizing that I can never convince them to abandon that habit, and they will never make me love it, I wondered what could be a possible middle ground: Giving them their reading comfort while keeping formatting conflicts out of the shared codebase.</p><h2 id=filling-t-softly>Filling <code>\t</code> Softly</h2><p>And that was when the scales fell from my eyes: This problem is not much unlike the one described in the first part. Applying soft line wrap is just one form of on-the-fly formatting in order to achieve a presentation of contents that optimally fits the output medium and the reader’s preferences. Why not do the same with tabular code alignment? Instead of “hard-coding” those extra spaces, just tell your editor which patterns you want to have aligned. And it shall present you the code just the way you like it. While your team-mates don’t have to cope with format-induced merge conflicts, lines depending on each other’s spacing, reading-flow-breaking gaps, and so on.</p><p>And guess what! I was not the first one who came up with that idea. A VS Code plug-in already exists since 2021: <a href=https://github.com/OldStarchy/Align-Spaces>Align-Spaces by OldStarchy</a>.</p><blockquote><p>Aligns certain operators by visually stretching the leading characters, this way you can have groups of aligned code, without having to deal with meaningless whitespace changes in your commits.</p></blockquote><p>I gave it a quick try and it works pretty well. Sure, there’s room for improvement. But anyways, it’s a great idea and a proper implementation. I wonder if there are others for different editors. If you happen to know one, please add it in a comment!</p><p>I think, this kind of responsive code presentation might be the key to solve a lot of conflicts in the bike-shedding and “Grabenkampf” areas of software development. Next time, let’s talk about <strong>Tabs vs. Spaces</strong> 😁</p><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p>“Grabenkampf” literally means <em>trench warfare</em>. In German it also has a <a href=https://de.wikipedia.org/wiki/Grabenkrieg#Figurative_Bedeutung>metaphorical meaning</a> of long-lasting arguments without real progress.&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></section><section id=sec:webmentions></section><script src=https://cdn.jsdelivr.net/npm/webmention.js@0.5.2/static/webmention.min.js data-id=sec:webmentions data-wordcount=100 async></script><section id=sec:comments><h2>Comments</h2><sz-root src=https://comments.sim.ilitu.de/comments/overcoming-code-format-disputes><noscript>JavaScript needed here.</noscript></sz-root></section><script type=module>
  import "https:\/\/comments.sim.ilitu.de/js/senfdazu/root_element.js";
  import BaseElement from "https:\/\/comments.sim.ilitu.de/js/simple/base_element.js";
  import md from "/js/md.js";

  const hlStyle = `<link rel="stylesheet" href="/css/hljs.css" />`;

  class MarkdownElement extends BaseElement {
    render(text) {
      this.innerHTML = md.render(text) + hlStyle;
    }
  }

  customElements.define("md-div", MarkdownElement);
</script></article></main><footer><section><p>© 2023 similitude</p></section></footer></body></html>